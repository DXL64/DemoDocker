# Chapter 2: MÃ´ hÃ¬nh há»c mÃ¡y phÃ¢n loáº¡i mÃ¨o/chÃ³


---

## Chuyá»ƒn tiáº¿p tá»« chÆ°Æ¡ng trÆ°á»›c

á» [ChÆ°Æ¡ng 1: á»¨ng dá»¥ng Flask phá»¥c vá»¥ dá»± Ä‘oÃ¡n mÃ¨o/chÃ³](01_á»©ng_dá»¥ng_flask_phá»¥c_vá»¥_dá»±_Ä‘oÃ¡n_mÃ¨o_chÃ³_.md), báº¡n Ä‘Ã£ biáº¿t cÃ¡ch gá»­i má»™t bá»©c áº£nh lÃªn á»©ng dá»¥ng Flask vÃ  nháº­n láº¡i káº¿t quáº£ lÃ  "mÃ¨o" hay "chÃ³". NhÆ°ng báº¡n cÃ³ bao giá» tá»± há»i: **LÃ m sao mÃ¡y tÃ­nh biáº¿t Ä‘Æ°á»£c Ä‘Ã¢u lÃ  mÃ¨o, Ä‘Ã¢u lÃ  chÃ³?**  
CÃ¢u tráº£ lá»i náº±m á»Ÿ "bá»™ nÃ£o" cá»§a há»‡ thá»‘ng â€“ **mÃ´ hÃ¬nh há»c mÃ¡y phÃ¢n loáº¡i mÃ¨o/chÃ³** mÃ  chÃºng ta sáº½ tÃ¬m hiá»ƒu trong chÆ°Æ¡ng nÃ y!

---

## 1. Äá»™ng lá»±c: MÃ¡y tÃ­nh phÃ¢n biá»‡t mÃ¨o vÃ  chÃ³ nhÆ° tháº¿ nÃ o?

HÃ£y tÆ°á»Ÿng tÆ°á»£ng báº¡n Ä‘Æ°a cho má»™t bÃ¡c sÄ© thÃº y má»™t bá»©c áº£nh vÃ  há»i: "ÄÃ¢y lÃ  mÃ¨o hay chÃ³?"  
BÃ¡c sÄ© sáº½ nhÃ¬n, phÃ¢n tÃ­ch cÃ¡c Ä‘áº·c Ä‘iá»ƒm (tai, mÅ©i, lÃ´ng,...) rá»“i tráº£ lá»i báº¡n.

MÃ´ hÃ¬nh há»c mÃ¡y cÅ©ng giá»‘ng nhÆ° má»™t "bÃ¡c sÄ© thÃº y áº£o" váº­y! NÃ³ Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n vá»›i hÃ ng ngÃ n bá»©c áº£nh mÃ¨o vÃ  chÃ³, Ä‘á»ƒ khi nháº­n Ä‘Æ°á»£c má»™t bá»©c áº£nh má»›i, nÃ³ cÃ³ thá»ƒ **phÃ¡n Ä‘oÃ¡n** vÃ  tráº£ lá»i báº¡n.

---

## 2. MÃ´ hÃ¬nh há»c mÃ¡y lÃ  gÃ¬?

### a. KhÃ¡i niá»‡m Ä‘Æ¡n giáº£n

- **MÃ´ hÃ¬nh há»c mÃ¡y** lÃ  má»™t chÆ°Æ¡ng trÃ¬nh mÃ¡y tÃ­nh Ä‘Æ°á»£c "dáº¡y" Ä‘á»ƒ nháº­n biáº¿t cÃ¡c máº«u (pattern) trong dá»¯ liá»‡u.
- Trong dá»± Ã¡n nÃ y, mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n Ä‘á»ƒ **phÃ¢n biá»‡t mÃ¨o vÃ  chÃ³ qua áº£nh**.

### b. MÃ´ hÃ¬nh hoáº¡t Ä‘á»™ng ra sao?

- Khi nháº­n má»™t bá»©c áº£nh, mÃ´ hÃ¬nh sáº½ **phÃ¢n tÃ­ch** cÃ¡c Ä‘áº·c Ä‘iá»ƒm cá»§a áº£nh.
- Sau Ä‘Ã³, nÃ³ **tÃ­nh toÃ¡n xÃ¡c suáº¥t** bá»©c áº£nh Ä‘Ã³ lÃ  mÃ¨o hay chÃ³.
- Cuá»‘i cÃ¹ng, nÃ³ **tráº£ vá» káº¿t quáº£**: "cat" hoáº·c "dog".

---

## 3. MÃ´ hÃ¬nh Ä‘Æ°á»£c lÆ°u trá»¯ vÃ  sá»­ dá»¥ng nhÆ° tháº¿ nÃ o?

### a. File mÃ´ hÃ¬nh

- Sau khi huáº¥n luyá»‡n, mÃ´ hÃ¬nh Ä‘Æ°á»£c lÆ°u láº¡i thÃ nh file:  
  **`cat_dog_classifier.hdf5`**
- File nÃ y giá»‘ng nhÆ° "bá»™ nÃ£o" Ä‘Ã£ há»c xong, sáºµn sÃ ng sá»­ dá»¥ng.

### b. Náº¡p mÃ´ hÃ¬nh vÃ o á»©ng dá»¥ng Flask

Khi á»©ng dá»¥ng Flask khá»Ÿi Ä‘á»™ng, nÃ³ sáº½ **náº¡p** mÃ´ hÃ¬nh nÃ y Ä‘á»ƒ sá»­ dá»¥ng cho viá»‡c dá»± Ä‘oÃ¡n.

```python
from keras.models import load_model

model_file = "models/cat_dog_classifier.hdf5"
model = load_model(model_file)
```

**Giáº£i thÃ­ch:**  
- DÃ²ng nÃ y sáº½ táº£i mÃ´ hÃ¬nh Ä‘Ã£ huáº¥n luyá»‡n tá»« file vÃ o bá»™ nhá»›, Ä‘á»ƒ sáºµn sÃ ng dá»± Ä‘oÃ¡n.

---

## 4. Quy trÃ¬nh dá»± Ä‘oÃ¡n: Tá»« áº£nh Ä‘áº¿n káº¿t quáº£

HÃ£y cÃ¹ng xem mÃ´ hÃ¬nh hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o khi nháº­n má»™t bá»©c áº£nh:

### a. CÃ¡c bÆ°á»›c chÃ­nh

1. **Nháº­n áº£nh** tá»« ngÆ°á»i dÃ¹ng (qua Flask).
2. **Xá»­ lÃ½ áº£nh**: ÄÆ°a áº£nh vá» Ä‘Ãºng kÃ­ch thÆ°á»›c, chuáº©n hÃ³a dá»¯ liá»‡u.
3. **Dá»± Ä‘oÃ¡n**: ÄÆ°a áº£nh vÃ o mÃ´ hÃ¬nh Ä‘á»ƒ tÃ­nh xÃ¡c suáº¥t.
4. **Tráº£ káº¿t quáº£**: Chá»n "cat" hoáº·c "dog" dá»±a vÃ o xÃ¡c suáº¥t.

### b. VÃ­ dá»¥ minh há»a

Giáº£ sá»­ báº¡n gá»­i lÃªn má»™t bá»©c áº£nh tÃªn `dog.jpg`.  
MÃ´ hÃ¬nh sáº½ tráº£ vá» káº¿t quáº£:

- Náº¿u xÃ¡c suáº¥t lÃ  0.8 â†’ Káº¿t quáº£: "dog"
- Náº¿u xÃ¡c suáº¥t lÃ  0.2 â†’ Káº¿t quáº£: "cat"

---

## 5. PhÃ¢n tÃ­ch tá»«ng bÆ°á»›c trong mÃ£ nguá»“n

ChÃºng ta sáº½ cÃ¹ng xem tá»«ng pháº§n quan trá»ng trong quÃ¡ trÃ¬nh dá»± Ä‘oÃ¡n.

### a. Äá»c vÃ  xá»­ lÃ½ áº£nh

```python
frame = cv2.imread(path_to_save)
frame = cv2.resize(frame, dsize=(150,150))
frame = np.expand_dims(frame, axis=0)
```

**Giáº£i thÃ­ch:**  
- Äá»c áº£nh tá»« file vá»«a lÆ°u.
- Äá»•i kÃ­ch thÆ°á»›c áº£nh vá» 150x150 pixel (giá»‘ng lÃºc huáº¥n luyá»‡n).
- ThÃªm má»™t chiá»u Ä‘á»ƒ phÃ¹ há»£p vá»›i Ä‘áº§u vÃ o cá»§a mÃ´ hÃ¬nh.

### b. ÄÆ°a áº£nh vÃ o mÃ´ hÃ¬nh Ä‘á»ƒ dá»± Ä‘oÃ¡n

```python
prediction_prob = model.predict(frame)[0][0]
```

**Giáº£i thÃ­ch:**  
- ÄÆ°a áº£nh Ä‘Ã£ xá»­ lÃ½ vÃ o mÃ´ hÃ¬nh.
- Nháº­n vá» má»™t giÃ¡ trá»‹ xÃ¡c suáº¥t (tá»« 0 Ä‘áº¿n 1).

### c. XÃ¡c Ä‘á»‹nh káº¿t quáº£ dá»± Ä‘oÃ¡n

```python
if prediction_prob < 0.5:
    output = "cat"
else:
    output = "dog"
```

**Giáº£i thÃ­ch:**  
- Náº¿u xÃ¡c suáº¥t nhá» hÆ¡n 0.5 â†’ dá»± Ä‘oÃ¡n lÃ  mÃ¨o.
- Náº¿u lá»›n hÆ¡n hoáº·c báº±ng 0.5 â†’ dá»± Ä‘oÃ¡n lÃ  chÃ³.

---

## 6. MÃ´ hÃ¬nh hoáº¡t Ä‘á»™ng bÃªn trong nhÆ° tháº¿ nÃ o?

### a. Quy trÃ¬nh tá»•ng quÃ¡t

HÃ£y hÃ¬nh dung quy trÃ¬nh nhÆ° sau:

```mermaid
sequenceDiagram
    participant NgÆ°á»i dÃ¹ng
    participant Flask
    participant MÃ´ hÃ¬nh

    NgÆ°á»i dÃ¹ng->>Flask: Gá»­i áº£nh
    Flask->>MÃ´ hÃ¬nh: ÄÆ°a áº£nh Ä‘Ã£ xá»­ lÃ½ vÃ o dá»± Ä‘oÃ¡n
    MÃ´ hÃ¬nh-->>Flask: Tráº£ xÃ¡c suáº¥t (0-1)
    Flask-->>NgÆ°á»i dÃ¹ng: Tráº£ káº¿t quáº£ (cat/dog)
```

**Giáº£i thÃ­ch:**  
- NgÆ°á»i dÃ¹ng gá»­i áº£nh lÃªn.
- Flask xá»­ lÃ½ áº£nh rá»“i chuyá»ƒn cho mÃ´ hÃ¬nh.
- MÃ´ hÃ¬nh phÃ¢n tÃ­ch vÃ  tráº£ vá» xÃ¡c suáº¥t.
- Flask dá»±a vÃ o xÃ¡c suáº¥t Ä‘á»ƒ tráº£ káº¿t quáº£ cho ngÆ°á»i dÃ¹ng.

---

### b. BÃªn trong mÃ´ hÃ¬nh há»c mÃ¡y

- MÃ´ hÃ¬nh há»c mÃ¡y thá»±c cháº¥t lÃ  má»™t máº¡ng nÆ¡-ron (neural network) Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n.
- Khi nháº­n áº£nh, nÃ³ sáº½ "soi" tá»«ng Ä‘iá»ƒm áº£nh, tÃ¬m cÃ¡c Ä‘áº·c Ä‘iá»ƒm giá»‘ng mÃ¨o hoáº·c chÃ³.
- Dá»±a vÃ o kinh nghiá»‡m Ä‘Ã£ há»c, nÃ³ sáº½ **phÃ¡n Ä‘oÃ¡n** vÃ  Ä‘Æ°a ra xÃ¡c suáº¥t.

---

## 7. VÃ­ dá»¥ thá»±c táº¿: Dá»± Ä‘oÃ¡n má»™t bá»©c áº£nh

Giáº£ sá»­ báº¡n gá»­i áº£nh `cat.jpg` lÃªn há»‡ thá»‘ng.

### a. áº¢nh Ä‘Æ°á»£c xá»­ lÃ½

```python
frame = cv2.imread("static/cat.jpg")
frame = cv2.resize(frame, (150,150))
frame = np.expand_dims(frame, axis=0)
```

### b. Dá»± Ä‘oÃ¡n

```python
prob = model.predict(frame)[0][0]
```

### c. Káº¿t quáº£

```python
if prob < 0.5:
    print("cat")
else:
    print("dog")
```

**Káº¿t quáº£:**  
Náº¿u áº£nh lÃ  mÃ¨o, mÃ´ hÃ¬nh sáº½ tráº£ vá» "cat".  
Náº¿u áº£nh lÃ  chÃ³, mÃ´ hÃ¬nh sáº½ tráº£ vá» "dog".

---

## 8. Má»™t sá»‘ lÆ°u Ã½ khi sá»­ dá»¥ng mÃ´ hÃ¬nh

- áº¢nh Ä‘áº§u vÃ o cáº§n Ä‘Ãºng kÃ­ch thÆ°á»›c (150x150 pixel).
- MÃ´ hÃ¬nh chá»‰ phÃ¢n biá»‡t Ä‘Æ°á»£c hai loáº¡i: mÃ¨o vÃ  chÃ³.
- Náº¿u áº£nh khÃ´ng rÃµ nÃ©t hoáº·c bá»‹ má», káº¿t quáº£ cÃ³ thá»ƒ khÃ´ng chÃ­nh xÃ¡c.

---

## 9. Tá»•ng káº¿t

Qua chÆ°Æ¡ng nÃ y, báº¡n Ä‘Ã£ hiá»ƒu:

- MÃ´ hÃ¬nh há»c mÃ¡y lÃ  "bá»™ nÃ£o" giÃºp phÃ¢n biá»‡t mÃ¨o vÃ  chÃ³ qua áº£nh.
- MÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n, lÆ°u thÃ nh file vÃ  náº¡p vÃ o á»©ng dá»¥ng Flask Ä‘á»ƒ sá»­ dá»¥ng.
- Khi nháº­n áº£nh, mÃ´ hÃ¬nh sáº½ phÃ¢n tÃ­ch vÃ  tráº£ vá» xÃ¡c suáº¥t, tá»« Ä‘Ã³ quyáº¿t Ä‘á»‹nh lÃ  mÃ¨o hay chÃ³.

á» chÆ°Æ¡ng tiáº¿p theo, báº¡n sáº½ há»c cÃ¡ch **Ä‘Ã³ng gÃ³i vÃ  triá»ƒn khai toÃ n bá»™ há»‡ thá»‘ng vá»›i Docker** Ä‘á»ƒ cÃ³ thá»ƒ cháº¡y á»Ÿ báº¥t ká»³ Ä‘Ã¢u má»™t cÃ¡ch dá»… dÃ ng!

ğŸ‘‰ [ChÆ°Æ¡ng 3: Há»‡ thá»‘ng Ä‘Ã³ng gÃ³i vÃ  triá»ƒn khai vá»›i Docker](03_há»‡_thá»‘ng_Ä‘Ã³ng_gÃ³i_vÃ _triá»ƒn_khai_vá»›i_docker_.md)

